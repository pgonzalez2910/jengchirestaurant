<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Mooncake Checkout</title>
</head>
<body>
  <h1>Jeng Chi â€¢ Mooncake Checkout</h1>
  <button id="pay">Pay Now</button>

  <script>
    document.getElementById("pay").addEventListener("click", async () => {
      try {
        const res = await fetch("http://127.0.0.1:54321/functions/v1/checkout", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            lineItems: [{
              price_data: {
                currency: "usd",
                product_data: { name: "Test Mooncake" },
                unit_amount: 2500
              },
              quantity: 1
            }]
          })
        });

        const data = await res.json();
        console.log("Response from server:", data);

        if (data.url) {
          window.location.href = data.url;  // ðŸš€ Redirect to Stripe Checkout
        } else {
          alert("No checkout URL received: " + JSON.stringify(data));
        }
      } catch (err) {
        console.error("Fetch failed:", err);
        alert("Error: " + err);
      }
    });
  </script>
</body>
</html>
