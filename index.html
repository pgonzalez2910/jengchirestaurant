<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Inventory Management System</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family:'Montserrat',sans-serif; margin:0; display:flex; flex-direction:column; height:100vh; background:#F3F4F6; }
    .main-border { border:8px solid #7A3D36; flex:1; display:flex; flex-direction:column; }
    .main-content { flex:1; display:flex; }
    .left-section, .right-section { flex:1; display:flex; justify-content:center; align-items:center; background:#fff; flex-direction:column; text-align:center; padding:2rem; }
    .system-title { color:#7A3D36; font-weight:700; margin-top:1rem; }
    .login-container { width:90%; max-width:400px; }
    .form-group { margin-bottom:1.2rem; text-align:left; }
    .form-group label { font-weight:600; color:#1f2937; display:block; margin-bottom:.3rem; }
    .form-group input { width:100%; padding:.75rem; border:1px solid #e5e7eb; border-radius:8px; }
    .form-group input:focus { outline:none; border-color:#7A3D36; box-shadow:0 0 0 3px rgba(122,61,54,.1); }
    .login-btn { width:100%; background:linear-gradient(to right,#6EE7B7,#34D399); color:#fff; padding:.75rem; border:none; border-radius:8px; font-size:1rem; font-weight:700; cursor:pointer; }
    .login-btn:hover { background:linear-gradient(to right,#34D399,#10B981); }
    .error-message { color:#DC2626; margin-top:.75rem; font-weight:600; display:none; }
    .navbar { background:#fff; padding:.8rem 1.25rem; box-shadow:0 2px 4px rgba(0,0,0,.08); display:flex; justify-content:flex-start; align-items:center; gap:1rem; }
    .nav-links a { font-weight:700; color:#4B5563; padding:.45rem .9rem; border-radius:10px; }
    .nav-links a:hover { background:#F3F4F6; }
    .nav-links a.active { background:linear-gradient(90deg,#7A3D36,#5f302b); color:#fff; }
    .logout-link { font-weight:700; color:#B91C1C; padding:.45rem .9rem; border-radius:10px; cursor:pointer; }
    .logout-link:hover { background:#FEE2E2; }
    .frame-wrap { flex:1; display:flex; }
    iframe { flex:1; border:none; }
    footer { padding:.5rem; background:linear-gradient(135deg,#1f2937 0%,#000 100%); color:#fff; text-align:center; font-size:.8rem; }
    #dashboard { display:none; flex:1; flex-direction:column; }
  </style>
</head>
<body class="main-border">

  <!-- LOGIN -->
  <div id="login-section" class="main-content">
    <div class="left-section">
      <img src="https://raw.githubusercontent.com/pgonzalez2910/jengchi-product-images/main/jengchilogo.jpg" alt="Logo" class="w-full max-w-[320px]" />
      <h1 class="system-title">INVENTORY MANAGEMENT SYSTEM</h1>
     
    </div>
    <div class="right-section">
      <div class="login-container">
        <form id="login-form">
          <div class="form-group">
            <label for="username">Username</label>
            <input id="username" type="text" required />
          </div>
          <div class="form-group">
            <label for="password">Password</label>
            <input id="password" type="password" required />
          </div>
          <p id="error-message" class="error-message"></p>
          <button type="submit" class="login-btn">Login</button>
        </form>
      </div>
    </div>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard">
    <div class="navbar">
      <nav id="tabs" class="nav-links flex space-x-2"></nav>
      <a id="logoutBtn" class="logout-link">Logout</a>
    </div>
    <div class="frame-wrap">
      <iframe id="moduleFrame"></iframe>
    </div>
  </div>

  <footer>Â© <span id="year"></span> Jeng Chi Developed by Pablo Gonzalez </footer>

  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    const SUPABASE_URL = "https://kpldzwlftkvjjntgsqxx.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtwbGR6d2xmdGt2ampudGdzcXh4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY2MzE5NzAsImV4cCI6MjA2MjIwNzk3MH0.qnWbOQv2RLPsIyO-oRwQkAN2VhmmdhTBt46SweUsLbs";
    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const ACL = {
       PG:['check','invoices','order','rony','julio','employeetrack','pl'],
       JT:['check','invoices','order','rony','julio','employeetrack','pl'],
       FT:['check','invoices','order','rony','julio','employeetrack','pl'],
       RC:['rony'],
       JM:['julio']
    };
    const TAB_MAP = {
      check:'check.html', invoices:'invoices.html', order:'placeorder.html',
      rony:'rony.html', julio:'julio.html', employeetrack:'employeetrack.html'
    };
    const TAB_LABELS = {
  check: 'Check Management',
  invoices: 'Invoice Management',
  order: 'Order Management',
  rony: 'General Order List',
  julio: 'Kitchen Prep Order List',
  employeetrack: 'Employee Tracker Management',
  pl: 'P & L Management'
};

    const loginForm=document.getElementById('login-form');
    const usernameInput=document.getElementById('username');
    const passwordInput=document.getElementById('password');
    const errorMessage=document.getElementById('error-message');

    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      errorMessage.style.display='none';
      const raw=(usernameInput.value||'').trim();
      const password=passwordInput.value;

      try {
        const candidates=[raw, raw.toUpperCase(), raw.toLowerCase()];
        const { data, error } = await supabaseClient
          .from('users')
          .select('username,password')
          .in('username', candidates);

        if(error){ errorMessage.textContent='Database error'; errorMessage.style.display='block'; return; }
        const row=(data||[]).find(r=>r.username.toUpperCase()===raw.toUpperCase());
        if(!row || row.password!==password){ errorMessage.textContent='Invalid username or password'; errorMessage.style.display='block'; return; }

        const user=row.username.toUpperCase();
        localStorage.setItem('currentUser', user);
        startDashboard(user);
      } catch(err){
        console.error(err);
        errorMessage.textContent='Unexpected error'; errorMessage.style.display='block';
      }
    });

    function startDashboard(user){
      document.getElementById('login-section').style.display='none';
      document.getElementById('dashboard').style.display='flex';
      const allowed=ACL[user]||[];
      const tabsEl=document.getElementById('tabs');
      const frame=document.getElementById('moduleFrame');

      function renderTabs(active){
        tabsEl.innerHTML=allowed.map(k=>`<a href=\"#\" data-key=\"${k}\" class=\"${active===k?'active':''}\">${TAB_LABELS[k]}</a>`).join('');
        tabsEl.querySelectorAll('a').forEach(a=>a.addEventListener('click',e=>{e.preventDefault();mount(a.dataset.key);}));
      }
      function mount(k){ renderTabs(k); frame.src=TAB_MAP[k]; }
      mount(allowed[0]);

      document.getElementById('logoutBtn').onclick=()=>{ localStorage.clear(); location.reload(); };
    }
  </script>
</body>
</html>




