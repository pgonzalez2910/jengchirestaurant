<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inventory Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family:'Montserrat',sans-serif; margin:0; display:flex; flex-direction:column; height:100vh; background:#F3F4F6; }
    .navbar { background:#fff; padding:.8rem 1.25rem; box-shadow:0 2px 4px rgba(0,0,0,.08); display:flex; justify-content:space-between; align-items:center; }
    .nav-links a { font-weight:700; color:#4B5563; padding:.45rem .9rem; border-radius:10px; }
    .nav-links a:hover { background:#F3F4F6; color:#111827; }
    .nav-links a.active { background:linear-gradient(90deg,#7A3D36,#5f302b); color:#fff; }
    .frame-wrap { flex:1; display:flex; position:relative; }
    .loader { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; }
    .spinner { width:42px; height:42px; border:4px solid #e5e7eb; border-top-color:#7A3D36; border-radius:50%; animation:spin 1s linear infinite; }
    @keyframes spin { to{ transform:rotate(360deg) } }
    iframe { flex:1; border:none; }
    footer { padding:.5rem 1rem; background:linear-gradient(135deg,#1f2937 0%,#000 100%); color:#fff; text-align:center; font-size:.8rem; }
    /* Dropdown Menu */
    .menu { position:relative; display:inline-block; }
    .menu-button { background:#7A3D36; color:#fff; font-weight:700; padding:.5rem 1rem; border-radius:8px; cursor:pointer; }
    .menu-content { display:none; position:absolute; right:0; background:#fff; min-width:160px; box-shadow:0 4px 6px rgba(0,0,0,.2); border-radius:8px; overflow:hidden; z-index:100; }
    .menu-content a { color:#1f2937; padding:.75rem 1rem; display:block; text-decoration:none; font-weight:600; }
    .menu-content a:hover { background:#F3F4F6; }
    .menu:hover .menu-content { display:block; }
  </style>
</head>
<body>
  <div class="navbar">
    <nav id="tabs" class="nav-links space-x-2"></nav>
    <div class="menu">
      <div class="menu-button">Menu ▾</div>
      <div class="menu-content">
        <a href="#" id="logoutBtn">Logout</a>
      </div>
    </div>
  </div>

  <div class="frame-wrap">
    <div id="frameLoader" class="loader"><div class="spinner"></div></div>
    <iframe id="moduleFrame"></iframe>
  </div>

  <footer>© <span id="year"></span> Jeng Chi</footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    const ACL = {
      PG:['check','invoices','order','rony','julio','employeetrack'],
      JT:['check','invoices','order','rony','julio','employeetrack'],
      FT:['check','invoices','order','rony','julio','employeetrack'],
      RC:['rony'],
      JM:['julio']
    };
    const TAB_MAP = {
      check:'check.html', invoices:'invoices.html', order:'placeorder.html',
      rony:'rony.html', julio:'julio.html', employeetrack:'employeetrack.html'
    };
    const TAB_LABELS = {
      check:'Check Management', invoices:'Invoice Management', order:'Order Management',
      rony:'General List', julio:'Kitchen Prep List', employeetrack:'Employee Track Management'
    };

    const currentUser=(localStorage.getItem('currentUser')||'').toUpperCase();
    const allowed=ACL[currentUser]||[];
    if(!allowed.length){window.location.reload();}

    const tabsEl=document.getElementById('tabs');
    const frame=document.getElementById('moduleFrame');
    const loader=document.getElementById('frameLoader');

    function renderTabs(active){
      tabsEl.innerHTML=allowed.map(k=>`<a href="#" data-key="${k}" class="${active===k?'active':''}">${TAB_LABELS[k]}</a>`).join('');
      tabsEl.querySelectorAll('a').forEach(a=>a.addEventListener('click',e=>{e.preventDefault();mount(a.dataset.key);}));
    }

    function mount(k){
      renderTabs(k);
      frame.src=TAB_MAP[k];
      loader.style.display='flex';
      frame.onload=()=>loader.style.display='none';
      localStorage.setItem('lastTab',k);
    }

    document.getElementById('logoutBtn').addEventListener('click',()=>{localStorage.clear();location.reload();});

    const startTab=localStorage.getItem('lastTab')&&allowed.includes(localStorage.getItem('lastTab'))?localStorage.getItem('lastTab'):allowed[0];
    mount(startTab);
  </script>
</body>
</html>
